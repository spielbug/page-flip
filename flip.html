<!--
 Page flip effect implemented using javascript and jquery
 I wanted page flipping effect for my app. turn.js seemed very best candidate, but unfortunately it didn't work
 for my project and it was difficult to hack. So I decided to develop my own script. It's not car with just key.
 it is just bundle of math but not so difficult. After looking at code, I want someone to continue add functionality
 to this simple source
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>page-flip</title>
    <!--<link rel="stylesheet" type="text/css" src="epub/OEBPS/content/css/common.css">-->
    <!--<link rel="stylesheet" type="text/css" src="epub/OEBPS/content/css/page.css">-->
    <style>
        html, body
        {
            height: 100%;
            margin: 0px;
            padding: 0px;
            //overflow: hidden;
        }
        #fb {
            position:relative;
            margin:auto;
            margin-top:30px;
        }
        .fb-wrapper {
            box-shadow: 0px 0px 15px rgba(0,0,0,0.1);
        }
        .flip-bottom,.flip-top {
            box-shadow: 5px 5px 15px rgba(0,0,0,0.1);
        }
        .flip-top {
            cursor : pointer;
        }
        .flipper {
            border:1px black solid;
        }

/*
이걸 활성화하면 div 아이콘이 커진다 왜일까...
        div {
            width:500px;height:500px;
        }
*/
    </style>
</head>
<body>

<div id="fb" style="display:none;">
    <iframe class="page" id="page1" style="background: teal;">1</iframe>
    <iframe class="page" id="page2" style="background: gold;">2</iframe>
    <iframe class="page" id="page3" style="background: moccasin;">3</iframe>
    <iframe class="page" id="page4" style="background: darkcyan;">4</iframe>
    <iframe class="page" id="page5" style="background: moccasin;">5</iframe>
    <iframe class="page" id="page6" style="background: darkcyan;">6</iframe>
</div>
<!--<div id="fb-control" style="position:absolute; left:0px; top:0px; width:100%; height:100%; z-index:10;"></div>-->

<!-- you will need jquery somewhere -->
<script src="libs/jquery.js"></script>
<script src="flip.js"></script>
<script src="loader.js"></script>

<script>

    _flip = Flip()

    function duplicate(src, dst) {
        dst=(dst.fn)?dst:$(dst)
        src=(src.fn)?src:$(src)
        var s = replace(
            src[0].contentDocument.head.innerHTML+src[0].contentDocument.body.innerHTML,
            'epub/OEBPS/content/')
        dst.html(s)
    }

    function replace(s, prefix) {

        s = s.replace(/src=\"/gi,'src="'+prefix+'')
        s = s.replace(/href=\"/gi,'href="'+prefix+'')
        s = s.replace(/url\(\"/gi,'url("'+prefix+'')
        return s;
    }

    function deg2rad(deg) {
        return deg/180*Math.PI
    }

    function rad2deg(rad) {
        return rad*180/Math.PI
    }

    /*
     EasingFunctions is extracted from open source bezier easing
     https://github.com/gre/bezier-easing
     */
    EasingFunctions = {
        // no easing, no acceleration
        linear: function (t) { return t },
        // accelerating from zero velocity
        easeInQuad: function (t) { return t*t },
        // decelerating to zero velocity
        easeOutQuad: function (t) { return t*(2-t) },
        // acceleration until halfway, then deceleration
        easeInOutQuad: function (t) { return t<.5 ? 2*t*t : -1+(4-2*t)*t },
        // accelerating from zero velocity
        easeInCubic: function (t) { return t*t*t },
        // decelerating to zero velocity
        easeOutCubic: function (t) { return (--t)*t*t+1 },
        // acceleration until halfway, then deceleration
        easeInOutCubic: function (t) { return t<.5 ? 4*t*t*t : (t-1)*(2*t-2)*(2*t-2)+1 },
        // accelerating from zero velocity
        easeInQuart: function (t) { return t*t*t*t },
        // decelerating to zero velocity
        easeOutQuart: function (t) { return 1-(--t)*t*t*t },
        // acceleration until halfway, then deceleration
        easeInOutQuart: function (t) { return t<.5 ? 8*t*t*t*t : 1-8*(--t)*t*t*t },
        // accelerating from zero velocity
        easeInQuint: function (t) { return t*t*t*t*t },
        // decelerating to zero velocity
        easeOutQuint: function (t) { return 1+(--t)*t*t*t*t },
        // acceleration until halfway, then deceleration
        easeInOutQuint: function (t) { return t<.5 ? 16*t*t*t*t*t : 1+16*(--t)*t*t*t*t }
    }

    $('iframe')
        .attr('border','0')
        .attr('cellpadding','0')
        .attr('cellspacing','0')
        .attr('frameBorder','0')
        .attr('seamless','seamless')
        .attr('width','500')
        .attr('height','500')
        .attr('marginheight','0')
        .attr('marginwidth','0')
        .attr('vspace','0')
        .attr('hspace','0')
        .attr('wmode','Opaque')
        .attr('scrolling','no')

    _book = Loader('epub/', function loaded(){
        console.log('manifest loaded')

        _book.registerHolders(['#page1','#page2','#page3','#page4','#page5','#page6'])
        _book.start()

    }).result

</script>

</body>

</html>